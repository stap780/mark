<% content_for :title, "Showing list" %>

<div class="md:w-2/3 w-full">
  <% if notice.present? %>
    <p class="py-2 px-3 bg-green-50 mb-5 text-green-500 font-medium rounded-md inline-block" id="notice"><%= notice %></p>
  <% end %>

  <h1 class="font-bold text-4xl">List</h1>

  <%= render @list %>

  <div class="mt-6">
    <h2 class="text-lg font-semibold mb-2">Items</h2>
    <div class="bg-white rounded-lg border p-4">
      <%= turbo_frame_tag dom_id(@list, :items) do %>
        <% if @list.list_items.any? %>
          <table class="min-w-full divide-y divide-gray-200">
            <thead>
              <tr>
                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500">Type</th>
                <th class="px-3 py-2 text-left text-xs font-medium text-gray-500">ID</th>
                <th class="px-3 py-2" />
              </tr>
            </thead>
            <tbody class="divide-y divide-gray-200">
              <% @list.list_items.each do |li| %>
                <tr id="<%= dom_id(li) %>">
                  <td class="px-3 py-2 text-sm text-gray-900"><%= li.item_type %></td>
                  <td class="px-3 py-2 text-sm text-gray-900"><%= li.item_id %></td>
                  <td class="px-3 py-2 text-right">
                    <%= button_to "Remove", account_list_list_item_path(current_account, @list, li), method: :delete, data: { turbo_confirm: "Remove item?" }, class: "inline-flex items-center rounded-md bg-red-600 px-2.5 py-1.5 text-sm font-medium text-white hover:bg-red-500" %>
                  </td>
                </tr>
              <% end %>
            </tbody>
          </table>
        <% else %>
          <div class="text-sm text-gray-600">No items yet.</div>
        <% end %>
      <% end %>

      <div class="mt-4">
        <%= form_with model: [current_account, @list, ListItem.new], data: { turbo_frame: dom_id(@list, :items) } do |f| %>
          <div class="flex gap-2 items-end">
            <div>
              <%= f.label :item_type, class: "block text-sm font-medium text-gray-700" %>
              <%= f.text_field :item_type, class: "mt-1 block w-40 rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm" %>
            </div>
            <div>
              <%= f.label :item_id, class: "block text-sm font-medium text-gray-700" %>
              <%= f.number_field :item_id, class: "mt-1 block w-40 rounded-md border-gray-300 shadow-sm focus:border-violet-500 focus:ring-violet-500 sm:text-sm" %>
            </div>
            <div>
              <%= f.submit "Add", class: "inline-flex items-center rounded-md bg-violet-600 px-3 py-2 text-sm font-medium text-white hover:bg-violet-500" %>
            </div>
          </div>
        <% end %>
      </div>
    </div>
  </div>

  <%= link_to "Edit this list", edit_account_list_path(current_account, @list), class: "w-full sm:w-auto text-center rounded-md px-3.5 py-2.5 bg-gray-100 hover:bg-gray-50 inline-block font-medium" %>
  <%= link_to "Back to lists", account_lists_path(current_account), class: "w-full sm:w-auto text-center mt-2 sm:mt-0 sm:ml-2 rounded-md px-3.5 py-2.5 bg-gray-100 hover:bg-gray-50 inline-block font-medium" %>
  <%= button_to "Destroy this list", account_list_path(current_account, @list), method: :delete, form_class: "sm:inline-block mt-2 sm:mt-0 sm:ml-2", class: "w-full rounded-md px-3.5 py-2.5 text-white bg-red-600 hover:bg-red-500 font-medium cursor-pointer", data: { turbo_confirm: "Are you sure?" } %>
</div>
