<div class="max-w-3xl mx-auto">
  <div class="flex items-center justify-between mb-6">
    <h1 class="text-2xl font-bold">Payment #<%= @payment.id %></h1>
    <%= link_to t(:back), admin_payments_path, class: "inline-flex items-center px-4 py-1 bg-white text-violet-700 border border-violet-600 rounded-md hover:bg-violet-50" %>
  </div>

  <div class="bg-white rounded-lg shadow p-6 space-y-6">
    <dl class="grid grid-cols-2 gap-4">
      <div>
        <dt class="text-sm font-medium text-gray-500">Account</dt>
        <dd class="mt-1 text-sm text-gray-900"><%= @payment.subscription&.account&.name || @payment.subscription&.account_id %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Plan</dt>
        <dd class="mt-1 text-sm text-gray-900"><%= @payment.subscription&.plan&.name %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Amount</dt>
        <dd class="mt-1 text-sm text-gray-900"><%= @payment.amount %> ₽</dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Processor</dt>
        <dd class="mt-1 text-sm text-gray-900"><%= @payment.processor.humanize %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Payment Status</dt>
        <dd class="mt-1 text-sm text-gray-900"><%= @payment.status.humanize %></dd>
      </div>
      <div>
        <dt class="text-sm font-medium text-gray-500">Paid At</dt>
        <dd class="mt-1 text-sm text-gray-900"><%= @payment.paid_at&.strftime("%d.%m.%Y %H:%M") || '—' %></dd>
      </div>
      <% if @payment.invoice? %>
        <div>
          <dt class="text-sm font-medium text-gray-500">Invoice Number</dt>
          <dd class="mt-1 text-sm text-gray-900">#<%= @payment.id %></dd>
        </div>
      <% end %>
    </dl>

    <div class="border-t pt-4">
      <h2 class="text-lg font-semibold mb-3">Update Status</h2>
      <%= form_with model: [:admin, @payment], method: :patch, class: "flex items-center space-x-3" do |f| %>
        <%= f.select :status, Payment.statuses.keys.map { |s| [s.humanize, s] }, {}, class: "block w-48 rounded-md border-gray-300 px-3 py-2" %>
        <%= f.submit "Save", class: "inline-flex items-center px-4 py-2 bg-violet-600 text-white rounded-md hover:bg-violet-700" %>
      <% end %>
      <% if @payment.invoice? && @payment.pending? %>
        <div class="mt-3">
          <%= button_to "Confirm Payment", admin_payment_path(@payment, payment: { status: :succeeded }), method: :patch,
                class: "inline-flex items-center px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700" %>
        </div>
      <% end %>
    </div>
  </div>
</div>


